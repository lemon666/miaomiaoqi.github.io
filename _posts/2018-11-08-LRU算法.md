---
layout: post
title:  "LRU算法"
date:   2018-11-08 14:37:04
categories: Algorithm
tags: 内存管理算法
author: miaoqi
---

* content
{:toc} 

## 简介

* 在做用户系统时, 用户信息当然是存在数据库里。但是由于我们对用户系统的性能要求比较高，显然不能每一次请求都去查询数据库。

    所以，在内存中创建了一个哈希表作为缓存，每次查找一个用户的时候先在哈希表中查询，以此提高访问性能。

    当用户量越来越多的时候, 当初设计的哈希表将内存撑爆, 造成了内存溢出

## 解决办法

* 提升机器配置

    可以提升机器的硬件配置, 对于没钱的公司该方法不太适用, 成本太高

* 随机清除哈希表

    如果恰好清除的是高频用户, 会造成性能降低

* LRU算法

    LRU全称 Least Recently Used, 也就是最近最少使用的意思, 是一种内存管理算法, 最早应用于Linux操作系统.

    LRU算法基于一种假设: 长期不被使用的数据, 在未来被用到的几率也不大. 因此, 当数据所占内存达到一定阈值时, 我们要移除掉最近最少使用的数据.

    在LRU算法中, 使用了一种有趣的数据结构, 这种数据结构叫做哈希链表
    
    我们都知道，哈希表是由若干个Key-Value所组成。在“逻辑”上，这些Key-Value是无所谓排列顺序的，谁先谁后都一样

    ![http://miaomiaoqi.cn/images/algorithm/lru_1.png](http://miaomiaoqi.cn/images/algorithm/lru_1.png)

    在哈希链表当中，这些Key-Value不再是彼此无关的存在，而是被一个链条串了起来。每一个Key-Value都具有它的前驱Key-Value、后继Key-Value，就像双向链表中的节点一样。

    ![http://miaomiaoqi.cn/images/algorithm/lru_2.png](http://miaomiaoqi.cn/images/algorithm/lru_2.png)

    这样一来，原本无序的哈希表拥有了固定的排列顺序。

    依靠哈希链表的有序性, 我们可以把Key-Value按照最后的使用时间来排序








