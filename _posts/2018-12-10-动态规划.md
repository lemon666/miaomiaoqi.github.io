---
layout: post
title:  "动态规划"
date:   2018-12-10 11:27:41
categories: Algorithm
tags: 动态规划
author: miaoqi
---

* content
{:toc}
## 题目一

* 有一座高度是**10**级台阶的楼梯，从下往上走，每跨一步只能向上**1**级或者**2**级台阶。要求用程序来求出一共有多少种走法。

	比如，每次走1级台阶，一共走10步，这是其中一种走法。我们可以简写成 1,1,1,1,1,1,1,1,1,1。

	再比如，每次走2级台阶，一共走5步，这是另一种走法。我们可以简写成 2,2,2,2,2。

## 动态规划

* 动态规划的英文名是Dynamic Programming, 是一种分阶段求解决策问题的数学思想. 它不止用于编程领域, 也应用于管理学, 经济学, 生物学.

	总结一句话就是**大事化小, 小事化了**

* 以刚才的题目来说, 假设只差最后一步就走到第10级台阶了, 这时候会有几种情况呢?

	答案是两种情况, 因为每一步只许走1级或是2级. 第一种是从9级走到10级, 第二种是从8级走到10级

* 接下来引出一个新的问题, 如果我们已知0到9级台阶走法有X种, 0到8级台阶有Y中走法, 那么0到10级台阶的走法有多少种?

	10级台阶的走法可以根据最后一步的不同而分为两部分, 第一部分的最后一步是从9级到10级, 这部分的走法数量和9级台阶的走法数量是相等的, 也就是X

	第二部分是最后一步从8级到10级, 这部分的走法数量和8级台阶的走法数量是相等的, 也就是Y.

	这两部分相加, 总的走法数量就是X + Y

	![http://www.miaomiaoqi.cn/images/algorithm/dynamic_1.png](http://www.miaomiaoqi.cn/images/algorithm/dynamic_1.png)

	为了方便表达, 我们把10级台阶的走法数量简写为F(10), 此时F(10) = F(9) + F(8), 那么如何计算F(9)和F(8)呢?

	利用刚才的思路可以很容易推断出:

	F(9) = F(8) + F(7), F(8) = F(7) + F(6)

	**我们正在把一个复杂分阶段进行简化, 逐步简化成简单问题, 这就是动态规划的思想.**

	当只有1级台阶和2级台阶的时候, 有几种走法呢?显然分别是1和2, 由此可以归纳出如下的公式:

	* F(1) = 1

		F(2) = 2
		F(n) = F(n - 1) + F(n - 2) (n >= 3)

	**动态规划当中包含了三个重要的概念**

	* 最优子结构

		刚才我们分析出F(10) = F(9) + F(8), 因此F(9)和F(8)是F(10)的最**优子结构**

	* 边界

		当只有1级台阶或2级台阶时, 我们可以直接得出结果, 无需继续简化. 我们称F(1)和F(2)是问题的**边界**, 如果一个问题没有边界, 将永远无法得到有限的结果

	* 状态转移公式

		F(n) = F(n - 1) + F(n - 2) 是阶段与阶段之间的**状态转移方程**, 这是动态规划的核心, 决定了问题每一个阶段和下一阶段的关系

	以上是动态规划的前半部分: **问题建模**, 接下来是真正麻烦的阶段: **问题求解**

	* 方法一: 递归求解

		要计算出F(N), 首先要得到F(N - 1)和F(N - 2)的值. 要计算F(N - 1)就要得到F(N - 2)和F(N - 3)的值...以此类推, 可以归纳成下面的图

		![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_2.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_2.png)

		这就是一颗二叉树, 树的节点个数就是我们的递归方法所需要计算的次数.

		不难看出这颗树的高度是N - 1, 节点个数接近2的N - 1次方. 所以方法的时间复杂度可以近似的看作是O(2 ^ N)

		上述图中存在大量的重复计算的值.

		![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_3.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_3.png)

		可以使用哈希表每次把不同参数的计算结果存入哈希. 当遇到相同参数时, 再从哈希表中取出, 就不用重复计算了, 这种方式叫做**备忘录算法**

	* 方法二: 备忘录算法

		从F(1)到F(N)一共有N个不同的输入, 在哈希表里存了N - 2个结果, 抛出1和2的情况, 所以时间复杂度和空间复杂度都是O(N)

	虽然我们的性能已经得到了明显的优化, 但这还不是真正的动态规划, 时间复杂度已经不能再小了, 在空间复杂度上还能不能在缩小了呢?

	**我们不妨把思路逆转过来**, 我们一定要对F(N)自顶向下做递归运算吗?可不可以自底向上, 用迭代的方式推导出结果?

	* 方法三: 动态规划求解

		![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_4.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_4.png)

		表格的第一行代表了楼梯台阶的数量, 第二行代表了若干级台阶对应的走法数. F(1) = 1, F(2) = 2, 这是之前已经明确过的

		![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_5.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_5.png)

		第一次迭代, 台阶数等于3时, 走法数量是3, 这个结果是F(1), F(2)这两个结果相加得来的, 所以F(3)只依赖F(1)和F(2)

		![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_6.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_6.png)

		第二次迭代, 台阶数等于4时, 走法数量是5, 这个结果是F(2), F(3)这两个结果相加得来的, 所以F(4)只依赖F(2)和F(3)

		![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_7.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_7.png)

		同理, 在后续迭代中, F(5)只依赖于F(4)和F(3); F(6)只依赖于F(5),F(4)

		由此可见, 每一次迭代中, 只要保留之前的两个状态, 就可以推导出新的状态. 而不需要像备忘录算法那样, 这才是真正的动态规划

		程序从 i = 3 开始迭代，一直到 i = n 结束。每一次迭代，都会计算出多一级台阶的走法数量。迭代过程中只需保留两个临时变量a和b，分别代表了上一次和上上次迭代的结果。 为了便于理解，我引入了temp变量。temp代表了当前迭代的结果值。

## 题目二

* 有一个国家发现了5座金矿，每座金矿的黄金储量不同，需要参与挖掘的工人数也不同。参与挖矿工人的总数是10人。每座金矿要么全挖，要么不挖，不能派出一半人挖取一半金矿。要求用程序求解出，要想得到尽可能多的黄金，应该选择挖取哪几座金矿？

	![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_8.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_8.png)

	* 方法一: 排列组合

		每一座金矿都有挖与不挖两种选择，如果有N座金矿，排列组合起来就有2^N种选择。对所有可能性做遍历，排除那些使用工人数超过10的选择，在剩下的选择里找出获得金币数最多的选择。

	动态规划有三个核心元素: **最优子结构, 边界, 状态转移量**, 首先思考一下这个题目的最优子结构, 题目要求10个工人5个金矿时, 挖最多黄金的选择. **那么最优子结构应该是10个工人4个金矿时, 挖出最多金矿的选择**

	**第5个金矿存在挖与不挖两种选择. 如果不挖, 对应的最右子结构是上述的情况, 如果选择挖, 会占用掉一部分工人, 那么前4个金矿所分配的工人数量就是[10 - 第5个金矿所需人数], 而不再是10 了**, **所以说问题的最优子结构有两个, 一个是4金矿10工人时的最优选择, 一个是4金矿10 - 3工人时的最优选择**

	![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_9.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_9.png)

	接下来讨论4个金矿的最优选择和5个金矿的最优选择之间是什么样的关系呢?

	**5个金矿的最优选择, 就是(前4做金矿10工人的挖金数量)和(前4做金矿7工人挖金数量 + 第5座金矿的挖金数量)的最大值**

	![http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_10.png](http://www.miaomiaoqi.cn/iamges/algorithm/dynamic/dynamic_10.png)