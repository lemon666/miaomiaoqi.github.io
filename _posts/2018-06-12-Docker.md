---
layout: post
title:  "Docker学习"
date:   2018-06-12 21:12:38
categories: Container
tags: Docker
author: miaoqi
---

* content
{:toc}


# Docker介绍

## Docker 服务器与客户端

Docker是一个客户端-服务器(C/S)架构程序. Docker客户端只需要向 Docker 服务器或者守护进程发出请求, 服务器或者守护进程将完成所有工作并返回结果. Docker 提供了一个命令行工具Docker 以及一整套 RESTfulAPI. 你可以在同一台宿主机上运行 Docker 守护进程和客户端, 也可以从本地的 Docker 客户端连接到运行在另一台宿主机上的远程 Docker守护进程

![http://www.miaomiaoqi.cn/images/container/docker/docker_1.png](http://www.miaomiaoqi.cn/images/container/docker/docker_1.png)

## Docker 镜像与容器

镜像是构建 Docker 的基石. 用户基于镜像来运行自己的容器. 镜像也是 Docker 生命周期中的"构建"部分. 镜像是基于联合文件系统的一种层式结构, 由一系列指令一步一步构建出来

## 注册中心

Docker 用 Registry 来保存用户构建的镜像. Registry 分为公共和私有两种. Docker 公司运营公共的 Registry 叫做 Docker Hub. 用户可以在 Docker Hub 注册账号, 分享并保存自己的镜像



# 核心概念

docker镜像(Images): Docker镜像是用于创建Docker容器的模板

docker容器(Container): 容器是独立运行的一个或一组容器

docker客户端(Client): 客户端通过命令行或者其他工具使用Docker

docker主机(Host): 安装了Docker程序的机器(Docker直接安装在操作系统上)

docker仓库(Registry): Docker仓库用来保存镜像, 可以理解为代码控制中的代码仓库

# 使用Docker步骤

1. 安装Docker

1. 去Docker仓库找到这个软件对应的仓库

1. 使用Docker运行这个镜像, 这个镜像就会生成一个Docker容器

1. 对容器的启动停止就是对软件的启动停止

# 镜像操作

|操作|命令|说明|
|-----|-----|-----|
|检索|docker search redis|查看镜像信息|
|拉取|docker pull 镜像名:tag|:tag是可选的, tag表示标签, 多为软件的版本, 默认是latest|
|列表|docker images|查看所有本地镜像|
|删除|docker rmi image-id<br />docker rmi \`docker images -q\`|删除指定的本地镜像<br/>删除所有镜像|

# 容器操作

|操作|命令|说明|
|-----|-----|-----|
|创建|docker run --name container-name -d image-name:tag|-name: 自定义容器名<br />-d: 后台运行 image-name: 指定镜像模板<br />-i: 运行容器<br />-t: 容器启动后会进入其命令行<br />-v: 宿主机目录:容器目录(前者是宿主机目录, 后者是映射到宿主机上的目录), 可以使用多个-v 做多个映射<br />-p: 宿主机端口:容器端口(前者是宿主机端口, 后者是容器内的端口)|
|列表|docker ps|查看运行中的容器<br />-a: 查看全部容器|
|进入容器|docker exec -it container-id /bin/bash|进入容器|
|启动|docker start container-name/container-id|启动容器|
|文件拷贝|docker cp 需要拷贝的文件或目录 容器名称:容器目录|拷贝文件, 反之也可以|
|查看容器 ip|docker inspect container-id<br />docker inspect —format='{{.NetworkSettings.IPAddress}}' container-id|查看容器运行的各种数据<br />过滤想要的数据|
|停止|docker stop container-name/container-id|停止当前运行的容器|
|停止全部容器|docker stop $(docker ps -q)|停止全部容器|
|删除|docker rm container-id|删除指定容器|
|删除全部容器|docker rm $(docker ps -aq)|删除全部容器|
|容器日志|docker logs container-name/container-id||
|更多命令|https://docs.docker.com/engine/reference/commandline/docker/||

1. docker search tomcat

1. docker pull tomcat

1. docker run --name mytomcat -d tomcat:latest

1. docker run -d --name mytomcat -p 9999:8080 tomcat:latest

docker run -d --name mysql01 -e MYSQL_ROOT_PASSWORD=miaoqi -p 4306:3306 mysql

# 应用部署

## MySQL 部署

拉取 mysql 镜像    

```
docker pull mysql
```

创建容器

```
docker run -d --name=tensquare_mysql -p 33306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql
```

## Tomcat部署

拉取 tomcat 镜像

```
docker pull tomcat
```

创建容器

```

```

