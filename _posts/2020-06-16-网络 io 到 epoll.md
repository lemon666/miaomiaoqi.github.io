---
layout: post
title: 网络 io 到 epoll
categories: [Network]
description: 
keywords: 
---

* content
{:toc}


## 计算机基础

现代计算机中分为用户态和内核态, 一些危险操作例如 io 的读取只有内核态可以执行, 在我们的 java 程序中如果想要进行 io 的读取, CPU 会从用户态切换到内核态读取网卡上的数据, 再从内核态切换到用户态并返回数据, 这是一个非常消耗性能的操作

## BIO

```java
public static void main(String[] args) throws IOException {
    ServerSocket serverSocket = new ServerSocket();
    serverSocket.bind(new InetSocketAddress("127.0.0.1", 8888));

    while (true) {
        Socket socket = serverSocket.accept(); // 阻塞等待连接

        BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
        String line = null;
        while ((line = reader.readLine()) != null) { // 阻塞等待客户端输入数据
            System.out.println(line);
        }
        reader.close();
    }
}
```











![http://www.milky.show/images/net/epoll/epoll_1.png](http://www.milky.show/images/net/epoll/epoll_1.png)