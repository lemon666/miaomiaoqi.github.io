---
layout: post
title:  "JVM虚拟机"
date:   2018-05-17 21:12:38
categories: Java
tags: JVM
author: miaoqi
---

* content
{:toc}

## 虚拟机

1. Sun Classic VM

    * 世界上第一款商用的Java虚拟机

    * 只能使用纯解释器的方式来执行Java代码

1. Exact VM

    * Exact Memory Management准确试内存管理

    * 编译器和解释器混合工作以及两级即时编译器

    * 只在Solaris平台发布

    * 英雄气短

1. HotSpot VM

    * 称霸武林

1. K VM

    * Kilobyte简单, 轻量, 高度可移植
    
    * 在手机平台运行

1. JRockit

    * BEA公司

    * 世界上最快的Java虚拟机

    * 专注服务器端应用

    * 优势:    
    
        垃圾收集器
        
        MissionControl服务套件

1. J9

    * IBM公司

    * IBM Technology for Java Virtual Machine
    
1. Microsoft JVM

1. TaobaoVM


## 虚拟机工具

### jps

* jps(java process status)

* 本地虚拟机唯一id lvmid local virtual machine id

* jps -l 可以查看主类

* jps -m 进程所接受的输入参数

* jps -v 进程锁接受的vm参数

### jstat

* 监控虚拟机运行信息

* 类装载, 内存, 垃圾收集, jit编译的信息

### jinfo

* 实时查看和调整虚拟机参数

### jmap

* jmap -dump:format=b,file=/asf/a.bin pid

### jhat(jvm heap analysis tool)

### jstack

* 生成线程快照

    jstack -l pid

## 可视化虚拟机工具

### jConsole

* 内存监控

* 线程监控

* 死锁监控

### VisualVM

* 首页: https://visualvm.github.io/index.html

* 插件地址: https://visualvm.github.io/pluginscenters.html


## 性能调优

* 知识 + 工具 + 数据 + 经验

* 案例1

    频繁发生Full GC, 堆内存设置的过大, 而且大内存对象非常多, 所以会触发Full GC, 导致每次GC时间过长, 出现卡顿, 通过部署多个web容器, 减少每个web容器的堆内存来解决这个问题

* 案例2

    不定期内存溢出, 把内存加大也无济于事. 导出内存快照信息, 没有任何信息, 内存监控正常. 因为使用了NIO的堆外内存, 所以监控不到内存信息

* 案例3

    连接过度, 中间增加MQ

 
    
    