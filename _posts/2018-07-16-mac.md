---
layout: post
title:  "Mac学习"
date:   2018-07-16 15:12:38
categories: Others
tags: Mac
author: miaoqi
---

* content
{:toc} 

## 查看端口

* lsof -i :port

## 安装Homebrew

## 安装lrzsz

1. 首先mac自带的终端是不支持lrzsz的，需要下载安装iterm2，下载地址:

    [http://www.iterm2.cn/download][1]

1. 安装lrzsz

        brew install lrzsz

1. 安装脚本到mac指定目录，地址在:

    [https://github.com/mmastrac/iterm2-zmodem][2]

    保存 iterm2-send-zmodem.sh 和 iterm2-recv-zmodem.sh 到mac的 /usr/local/bin/ 路径下

    chmod +x iterm2-send-zmodem.sh 
    
    chmod +x iterm2-recv-zmodem.sh  

1. iterm2 添加 triggers

        Regular expression: \*\*B0100
        Action: Run Silent Coprocess
        Parameters: /usr/local/bin/iterm2-send-zmodem.sh
        
        Regular expression: \*\*B00000000000000
        Action: Run Silent Coprocess
        Parameters: /usr/local/bin/iterm2-recv-zmodem.sh

    添加步骤：command+“,” 组合键打开“Preferences”面板->Profiles选项卡->Advanced->Triggers（点击Edit即可）

1. 远程机器需要安装lrzsz

        sudo yum install -y lrzsz

## 安装sshpass

由于有一些场景不能使用ssh私钥来实现免登，因此需要想其它办法解决一下这个问题, ssh命令又不支持明文密码登录, 所以选用sshpass结合ssh实现明文登录功能

1. 使用brew安装sshpass

    brew install https://raw.githubusercontent.com/kadwanev/bigboybrew/master/Library/Formula/sshpass.rb
    
1. 配置sshpass环境变量

1. 查看sshpass命令可以使用-p指定明文密码

        Usage: sshpass [-f|-d|-p|-e] [-hV] command parameters
           -f filename   Take password to use from file
           -d number     Use number as file descriptor for getting password
           -p password   Provide password as argument (security unwise)
           -e            Password is passed as env-var "SSHPASS"
           With no parameters - password will be taken from stdin
        
           -P prompt     Which string should sshpass search for to detect a password prompt
           -v            Be verbose about what you're doing
           -h            Show help (this screen)
           -V            Print version information
        At most one of -f, -d, -p or -e should be used

1. 结合ssh命令实现明文密码登录

    sshpass -p明文密码 ssh user@ip -pport

## 免密登录远程服务器

在本地生成公钥和私钥，然后将公钥放到linux的root（也就是~）目录下的.ssh文件夹下（隐藏文件夹），如何没有则生成一个。 

1. 生成公私钥对

        ssh-keygen -t rsa
    
    之后回车两次，注：（Enter passphrase (empty for no passphrase): 可以设置密码），免密做好后首次登录要求输入一次密码，就输入这里的密码。

    在~/.ssh目录下会生成两个文件id_rsa（私钥）和id_rsa.pub（公钥）

1. 拷贝公钥内容到服务器

    将本地的~/.ssh/id\_rsa.pub内容粘贴到服务器的~/.ssh/authorized\_keys

1. 配置别名

    如果使用的是zsh, 可以修改配置文件指定ssh命令的别名快捷免密登录远程服务器


[1]: http://www.iterm2.cn/download
[2]: https://github.com/mmastrac/iterm2-zmodem





