---
layout: post
title: "Nginx服务器"
categories: [Server]
description:
keywords:
---

* content
{:toc} 
# 简介

Nginx 是一个高性能的 Web 和反向代理服务器

**作为 Web 服务器:** 相比 Apache, Nginx 使用更少的资源, 支持更多的并发连接, 提现更好的效率, 这点使 Nginx 尤其受到虚拟主机提供商的欢迎. 能够支持高达50000并发连接数的响应

**作为负载均衡服务器:** Nginx 既可以在内部直接支持 Rails 和 PHP, 也可以支持作为 Http 代理服务器对外进行服务. Nginx 用 C 编写

nginx可以作为web服务器，但更多的时候，我们把它作为网关，因为它具备网关必备的功能：

- 反向代理
- 负载均衡
- 动态路由
- 请求过滤

# 反向代理

什么是反向代理？

- 代理：通过客户机的配置，实现让一台服务器(代理服务器)代理客户机，客户的所有请求都交给代理服务器处理。
- 反向代理：用一台服务器，代理真实服务器，用户访问时，不再是访问真实服务器，而是代理服务器。

nginx可以当做反向代理服务器来使用：

- 我们需要提前在nginx中配置好反向代理的规则，不同的请求，交给不同的真实服务器处理
- 当请求到达nginx，nginx会根据已经定义的规则进行请求的转发，从而实现路由功能

# 负载均衡模式

* 轮询

    轮询是默认的，每一个请求按顺序逐一分配到不同的后端服务器，如果后端服务器down掉了，则能自动剔除

* ip_hash

    个请求按访问IP的hash结果分配，这样来自同一个IP的访客固定访问一个后端服务器，有效解决了动态网页存在的session共享问题。

* weight

    weight是设置权重，用于后端服务器性能不均的情况，访问比率约等于权重之比

* fair(第三方)

    这是比上面两个更加智能的负载均衡算法。此种算法可以依据页面大小和加载时间长短智能地进行负载均衡，也就是根据后端服务器的响应时间来分配请求，响应时间短的优先分配。Nginx本身是不支持fair的，如果需要使用这种调度算法，必须下载Nginx的upstream_fair模块。

* url_hash(第三方)

    此方法按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，可以进一步提高后端缓存服务器的效率。Nginx本身是不支持url_hash的，如果需要使用这种调度算法，必须安装Nginx 的hash软件包。
